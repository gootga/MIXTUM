<!DOCTYPE html>
<html lang="en" >
  <head>
    <meta charset="utf-8">
    <title>Mixtum: The geometry of admixture in population genetics</title>
    <link rel="apple-touch-icon" sizes="180x180" href="https://cdn.holoviz.org/panel/1.5.0-b.3/dist/images/apple-touch-icon.png">
    <link rel="icon" href="https://cdn.holoviz.org/panel/1.5.0-b.3/dist/images/favicon.ico" type="">
    <meta name="name" content="Mixtum: The geometry of admixture in population genetics">
    <style>
      html, body {
	display: flow-root;
        box-sizing: border-box;
        height: 100%;
        margin: 0;
        padding: 0;
      }
    </style>
    <link rel="stylesheet" href="https://cdn.holoviz.org/panel/1.5.0-b.3/dist/bundled/filedropper/filepond@^4/dist/filepond.css?v=1.5.0-b.3" type="text/css" />
    <link rel="stylesheet" href="https://cdn.holoviz.org/panel/1.5.0-b.3/dist/bundled/filedropper/filepond-plugin-image-preview/dist/filepond-plugin-image-preview.css?v=1.5.0-b.3" type="text/css" />
    <link rel="stylesheet" href="https://cdn.holoviz.org/panel/1.5.0-b.3/dist/bundled/filedropper/filepond-plugin-pdf-preview/dist/filepond-plugin-pdf-preview.css?v=1.5.0-b.3" type="text/css" />
    <link rel="stylesheet" href="https://cdn.holoviz.org/panel/1.5.0-b.3/dist/bundled/datatabulator/tabulator-tables@6.2.1/dist/css/tabulator_simple.min.css?v=1.5.0-b.3" type="text/css" />

<link rel="stylesheet" href="https://pyscript.net/releases/2024.8.1/core.css" />
<link rel="stylsheet" href="https://cdn.holoviz.org/panel/1.5.0-b.3/dist/css/pyscript.css" />
<style type="text/css">

:host(.pn-loading):before, .pn-loading:before {
  background-color: #c3c3c3;
  mask-size: auto calc(min(50%, 400px));
  -webkit-mask-size: auto calc(min(50%, 400px));
}
.py-error { display: none; }</style><script type="module" src="https://pyscript.net/releases/2024.8.1/core.js"></script>
<script type="esms-options">{"shimMode": true}</script>

<script type="text/javascript" src="https://cdn.holoviz.org/panel/1.5.0-b.3/dist/bundled/filedropper/filepond-plugin-image-preview/dist/filepond-plugin-image-preview.js"></script>
<script type="text/javascript" src="https://cdn.holoviz.org/panel/1.5.0-b.3/dist/bundled/filedropper/filepond-plugin-file-validate-size/dist/filepond-plugin-file-validate-size.js"></script>
<script type="text/javascript" src="https://cdn.holoviz.org/panel/1.5.0-b.3/dist/bundled/filedropper/filepond-plugin-file-validate-type/dist/filepond-plugin-file-validate-type.js"></script>
<script type="text/javascript" src="https://cdn.holoviz.org/panel/1.5.0-b.3/dist/bundled/filedropper/filepond-plugin-pdf-preview/dist/filepond-plugin-pdf-preview.min.js"></script>
<script type="text/javascript" src="https://cdn.holoviz.org/panel/1.5.0-b.3/dist/bundled/filedropper/filepond@^4/dist/filepond.js"></script>
<script type="text/javascript" src="https://cdn.holoviz.org/panel/1.5.0-b.3/dist/bundled/datatabulator/tabulator-tables@6.2.1/dist/js/tabulator.min.js"></script>
<script type="text/javascript" src="https://cdn.holoviz.org/panel/1.5.0-b.3/dist/bundled/datatabulator/luxon/build/global/luxon.min.js"></script>
<script type="text/javascript" src="https://cdn.bokeh.org/bokeh/release/bokeh-3.5.1.min.js"></script>
<script type="text/javascript" src="https://cdn.bokeh.org/bokeh/release/bokeh-gl-3.5.1.min.js"></script>
<script type="text/javascript" src="https://cdn.bokeh.org/bokeh/release/bokeh-widgets-3.5.1.min.js"></script>
<script type="text/javascript" src="https://cdn.bokeh.org/bokeh/release/bokeh-tables-3.5.1.min.js"></script>
<script type="text/javascript" src="https://cdn.holoviz.org/panel/1.5.0-b.3/dist/panel.min.js"></script>

<script type="module" src="https://cdn.holoviz.org/panel/1.5.0-b.3/dist/bundled/reactiveesm/es-module-shims@^1.10.0/dist/es-module-shims.min.js"></script>
<script type="text/javascript">
  Bokeh.set_log_level("info");
</script>    <!-- Template CSS -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato&subset=latin,latin-ext">
    <link rel="stylesheet" href="https://cdn.holoviz.org/panel/1.5.0-b.3/dist/css/loadingspinner.css">
    <link rel="stylesheet" href="https://cdn.holoviz.org/panel/1.5.0-b.3/dist/css/listpanel.css">
    <link rel="stylesheet" href="https://cdn.holoviz.org/panel/1.5.0-b.3/dist/css/alerts.css">
    <link rel="stylesheet" href="https://cdn.holoviz.org/panel/1.5.0-b.3/dist/css/button.css">
    <link rel="stylesheet" href="https://cdn.holoviz.org/panel/1.5.0-b.3/dist/bundled/font-awesome/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.holoviz.org/panel/1.5.0-b.3/dist/css/select.css">
    <link rel="stylesheet" href="https://cdn.holoviz.org/panel/1.5.0-b.3/dist/css/markdown.css">
    <link rel="stylesheet" href="https://cdn.holoviz.org/panel/1.5.0-b.3/dist/css/loading.css?v=1.5.0-b.3">
    <link rel="stylesheet" href="https://cdn.holoviz.org/panel/1.5.0-b.3/dist/bundled/theme/default.css?v=1.5.0-b.3">
    <link rel="stylesheet" href="https://cdn.holoviz.org/panel/1.5.0-b.3/dist/bundled/vanillatemplate/vanilla.css?v=1.5.0-b.3">

<style>
  :root {
    --header-background: var(--design-primary-color, var(--panel-primary-color));
    --header-color: var(--design-primary-text-color, var(--panel-on-primary-color));
    --sidebar-width: 330px;
  }
  #header {
    --background-color: var(--header-background);
    --text-color: var(--header-color);
    --design-background-text-color: var(--header-color);
    --design-background-color: var(--header-background);
    background-color: var(--header-background);
    color: var(--header-color);
    box-shadow: 5px 5px 20px silver;
  }
  #sidebar {
    width: var(--sidebar-width);
  }
</style>

    <style type="text/css">
    
:host(.pn-loading):before, .pn-loading:before {
  background-color: #c3c3c3;
  mask-size: auto calc(min(50%, 400px));
  -webkit-mask-size: auto calc(min(50%, 400px));
}
    </style>

    <!-- Template JS -->

  </head>
  <body class="pn-loading pn-arc">
<div id="container">
  <nav id="header">
    <div class="app-header">
      <a class="title" href="" >&nbsp;Mixtum: The geometry of admixture in population genetics</a>
    </div>
    <div id="header-items">
    </div>
    <div class="pn-busy-container">
      <div id="eff3c580-31c0-4ef9-a1d3-92d132000135" data-root-id="p1013" style="display: contents;"></div>
    </div>
  </nav>

  <div id="content">

    <div class="main" id="main">
      <div id="e1951108-e9a5-4bd4-985c-b104277be3bd" data-root-id="p1014" style="display: contents;"></div>

      <div id="pn-Modal" class="pn-modal header-adjust">
	<div class="pn-modal-content">
	  <span class="pn-modalclose" id="pn-closeModal">&times;</span>
	</div>
      </div>
    </div>
  </div>
</div>

<script>
  function openNav() {
    document.getElementById("sidebar").classList.remove("hidden");
    document.getElementById("sidebar-button").onclick = closeNav;
  }

  function closeNav() {
    document.getElementById("sidebar").classList.add("hidden");
    document.getElementById("sidebar-button").onclick = openNav;
  }

  var modal = document.getElementById("pn-Modal");
  var span = document.getElementById("pn-closeModal");

  span.onclick = function() {
    modal.style.display = "none";
  }

  window.onclick = function(event) {
    if (event.target == modal) {
      modal.style.display = "none";
    }
  }
</script>

<div id="dda4e455-a549-4269-914b-578d2206abf5" data-root-id="p1008" style="display: contents;"></div>
<div id="abb4e279-56c1-46be-84d3-d71adbf04eb8" data-root-id="p1010" style="display: contents;"></div>
<div id="a24e9980-6ead-4a99-8457-28cd5393503e" data-root-id="p1002" style="display: contents;"></div>
<div id="e2bdd23f-0e00-443d-bea3-a4d8cc7fde99" data-root-id="p1011" style="display: contents;"></div>


  <script type='py' config='{"packages": ["https://cdn.holoviz.org/panel/wheels/bokeh-3.5.1-py3-none-any.whl", "https://cdn.holoviz.org/panel/1.5.0-b.3/dist/wheels/panel-1.5.0b3-py3-none-any.whl", "pyodide-http==0.2.1", "matplotlib", "numpy", "pandas"]}'>
    import asyncio

    from panel.io.pyodide import init_doc, write_doc

    init_doc()

    from pathlib import Path
    from collections import defaultdict
    import numpy as np
    from time import time
    import matplotlib.pyplot as plt
    from matplotlib.figure import Figure
    import pandas as pd
    import panel as pn
    import io
    import zipfile
    from datetime import datetime



    pn.extension()
    pn.extension('tabulator')
    pn.extension('filedropper')



    # Globals

    geno_file_path = None
    ind_file_path = None
    snp_file_path = None
    #input_triad = {}

    populations_dict = defaultdict(list)
    populations = []

    parsed_sel_pops = []
    sel_pops = []
    snp_names = []

    num_alleles = 0
    allele_frequencies = defaultdict(list)

    invalid_indices = []
    num_valid_alleles = 0

    roles_pops = []

    hybrid = ''
    parent1 = ''
    parent2 = ''
    auxiliaries = []

    alpha_pre_jl = None

    f4ab_prime = None
    f4xb_prime = None
    alpha = None
    alpha_error = None

    f4ab_std = None
    f4xb_std = None
    alpha_std = None
    alpha_std_error = None

    alpha_ratio = None
    alpha_ratio_avg = None
    alpha_ratio_std_dev = None
    alpha_ratio_hist = None

    cosine_pre_jl = None
    angle_pre_jl = None
    percentage_pre_jl = None

    cosine_post_jl = None
    angle_post_jl = None
    percentage_post_jl = None

    num_cases = None

    f3_test = None



    # Input and output widgets

    zip_file_dropper = pn.widgets.FileDropper(accepted_filetypes = ['application/zip'], max_file_size = '1000MB', multiple = False)
    dat_file_dropper = pn.widgets.FileDropper(max_file_size = '1MB', multiple = False)
    load_files_button = pn.widgets.Button(name = 'Parse and check input files', button_type = 'primary', disabled = False)

    alert_pane = pn.pane.Alert('### Input files upload\nPlease, upload a ZIP with a triad of .geno, .ind and .snp input files, and optionally an input file with a list of selected populations.\nThen press the parse button.', alert_type = 'primary')

    reset_sel_pops_button = pn.widgets.Button(name = 'Reset selected populations', button_type = 'primary')

    compute_freqs_button = pn.widgets.Button(name = 'Compute allele frequencies', button_type = 'primary', disabled = True)
    freqs_download_button = pn.widgets.FileDownload(label = 'Download allele frequencies', disabled = True, button_type = 'primary')

    hybrid_select = pn.widgets.Select(name = 'Hybrid', options = [], size = 10)
    parent1_select = pn.widgets.Select(name = 'Parent 1', options = [], size = 10)
    parent2_select = pn.widgets.Select(name = 'Parent 2', options = [], size = 10)
    aux_pops_select = pn.widgets.MultiSelect(name = 'Auxiliaries', options = [], size = 10)


    plot_width_input = pn.widgets.FloatInput(name = 'Plot width (inches)', value = 4, step = 0.1, start = 0.1)
    plot_height_input = pn.widgets.FloatInput(name = 'Plot height (inches)', value = 4, step = 0.1, start = 0.1)
    plot_title_size_input = pn.widgets.IntInput(name = 'Plot title font size', value = 10, step = 1, start = 1)
    plot_label_size_input = pn.widgets.IntInput(name = 'Plot labels font size', value = 10, step = 1, start = 1)
    compute_results_button = pn.widgets.Button(name = 'Compute results', button_type = 'primary', disabled = True)
    results_download_button = pn.widgets.FileDownload(label = 'Download results', disabled = True, button_type = 'primary')
    f4_points_download_button = pn.widgets.FileDownload(label = 'Download f4-points', disabled = True, button_type = 'primary')
    resulting_data_output = pn.pane.Markdown()



    # Tables

    avail_pops_filter = pn.widgets.TextInput(name = 'Search populations:', placeholder = 'Enter population name', disabled = True)
    avail_pops_table = pn.widgets.Tabulator(show_index = False, disabled = True, selectable = False, pagination = 'local', page_size = 10, align = ('start'), widths = {'population': '100%'})
    sel_pops_table = pn.widgets.Tabulator(show_index = False, disabled = True, selectable = False, sortable = False, pagination = 'local', page_size = 10, align = ('start'), widths = {'population': '100%'}, buttons = {'remove': "<i class='fa fa-times'></i>"})



    # Plot panes

    pane_margin = 10

    f4prime_fit_pane = pn.pane.Matplotlib(align = ('center', 'start'), margin = pane_margin)
    f4_fit_pane = pn.pane.Matplotlib(align = ('center', 'start'), margin = pane_margin)
    f4_ratio_histogram_pane = pn.pane.Matplotlib(align = ('center', 'start'), margin = pane_margin)



    def set_alert_pane(text, type):
        alert_pane.object = text
        alert_pane.alert_type = type



    def reset_alert_pane(event):
        text = '### Input files upload\nPlease, upload a ZIP with triad of .geno, .ind and .snp input files, and optionally an input file with a list of selected populations.\nThen press the parse button.'
        alert_pane.object = text
        alert_pane.alert_type = 'primary'

        if zip_file_dropper.value:
            load_files_button.disabled = False
        else:
            load_files_button.disabled = True



    zip_file_dropper.param.watch(reset_alert_pane, 'value')



    def set_pops_table_data(pops, table):
        idx = list(range(len(pops)))
        df = pd.DataFrame({'population': pops}, index = idx)
        table.value = df



    def contains_filter(df, pattern, column):
        if not pattern:
            return df
        return df[df[column].str.contains(pattern, case = False)]



    avail_pops_table.add_filter(pn.bind(contains_filter, pattern = avail_pops_filter, column = 'population'))



    def set_sel_pops_data(event):
        global sel_pops

        pop = event.value
        if pop in sel_pops:
            sel_pops.remove(pop)
        else:
            sel_pops.insert(0, pop)

        set_pops_table_data(sel_pops, sel_pops_table)

        if len(sel_pops) > 0:
            compute_freqs_button.disabled = False
        else:
            compute_freqs_button.disabled = True



    avail_pops_table.on_click(set_sel_pops_data)



    def remove_sel_pop(event):
        if event.column != 'remove':
            return

        global sel_pops
        index = int(event.row)
        sel_pops.pop(index)

        set_pops_table_data(sel_pops, sel_pops_table)

        if len(sel_pops) == 0:
            compute_freqs_button.disabled = True



    sel_pops_table.on_click(remove_sel_pop)



    def set_admixture_model():
        global hybrid, parent1, parent2, auxiliaries

        hybrid = hybrid_select.value
        parent1 = parent1_select.value
        parent2 = parent2_select.value
        auxiliaries = aux_pops_select.value



    def init_selects_options():
        global roles_pops
        roles_pops = [pop for pop in sel_pops]

        hybrid_select.options = roles_pops
        parent1_select.options = roles_pops
        parent2_select.options = roles_pops
        aux_pops_select.options = roles_pops

        hybrid_select.value = roles_pops[0]
        parent1_select.value = roles_pops[1]
        parent2_select.value = roles_pops[2]
        aux_pops_select.value = roles_pops[3:]

        set_admixture_model()



    def set_selects_values(event):
        select_name = event.obj.name
        old_pop = event.old
        new_pop = event.new

        if select_name == 'Auxiliaries':
            pops = [hybrid_select.value, parent1_select.value, parent2_select.value]
            aux_pops_select.value = [pop for pop in new_pop if pop not in pops]
        else:
            if new_pop in aux_pops_select.value:
                aux_pops_select.value = [pop for pop in aux_pops_select.value if pop != new_pop]
            else:
                selects = []
                if select_name == 'Hybrid':
                    selects = [parent1_select, parent2_select]
                elif select_name == 'Parent 1':
                    selects = [hybrid_select, parent2_select]
                elif select_name == 'Parent 2':
                    selects = [hybrid_select, parent1_select]

                for sel in selects:
                    if sel.value == new_pop and old_pop != None:
                        sel.value = old_pop

        set_admixture_model()

        compute_results_button.disabled = (len(aux_pops_select.value) == 0)



    hybrid_select.param.watch(set_selects_values, 'value')
    parent1_select.param.watch(set_selects_values, 'value')
    parent2_select.param.watch(set_selects_values, 'value')
    aux_pops_select.param.watch(set_selects_values, 'value')



    def parse_selected_populations(data):
        global parsed_sel_pops
        read_sel_pops = []

        pop_lines = [line.split() for line in data.splitlines() if not line.startswith('#')]
        read_sel_pops = [pop_line[0] for pop_line in pop_lines]

        invalid_pops = []
        for pop in read_sel_pops:
            if not pop in populations:
                invalid_pops.append(pop)

        global sel_pops
        sel_pops = [pop for pop in read_sel_pops if pop not in invalid_pops]

        global parsed_sel_pops
        parsed_sel_pops = [pop for pop in read_sel_pops if pop not in invalid_pops]

        if len(sel_pops) > 0:
            set_pops_table_data(sel_pops, sel_pops_table)
            compute_freqs_button.disabled = False
        else:
            compute_freqs_button.disabled = True



    def reset_sel_pops(event):
        global sel_pops
        sel_pops = [pop for pop in parsed_sel_pops]
        set_pops_table_data(sel_pops, sel_pops_table)

        if len(sel_pops) == 0:
            compute_freqs_button.disabled = True
            freqs_download_button.disabled = True



    pn.bind(reset_sel_pops, reset_sel_pops_button, watch = True)



    def parse_populations():
        global populations_dict, populations

        populations_dict = defaultdict(list)
        populations = []

        num_rows = 0

        text = f'### Parsing and checking {ind_file_path}\n'
        text_lines = [text, '']

        #for index, row in enumerate(input_triad[ind_file_path]):
        for index, row in enumerate(pn.state.cache['.ind']):
            columns = row.split()
            pop_name = columns[-1]
            populations_dict[pop_name].append(index)

            num_rows += 1
            if (num_rows % 1000 == 0):
                text_lines[-1] = f'Number of rows: {num_rows}'
                set_alert_pane('\n'.join(text_lines), 'warning')

        populations = list(populations_dict.keys())

        return num_rows



    def parse_snp_names():
        global snp_names
        snp_names = []

        num_alleles = 0

        text = f'### Parsing and checking {snp_file_path}\n'
        text_lines = [text, '']

        #for row in input_triad[snp_file_path]:
        for row in pn.state.cache['.snp']:
            columns = row.split()
            snp_names.append(columns[0])

            num_alleles += 1
            if (num_alleles % 10000 == 0):
                text_lines[-1] = f'Number of alleles: {num_alleles}'
                set_alert_pane('\n'.join(text_lines), 'warning')

        return num_alleles



    def geno_table_shape():
        num_rows = 0
        num_columns = []

        text = f'### Parsing and checking {geno_file_path}\n'
        text_lines = [text, '']

        #for row in input_triad[geno_file_path]:
        #for row in pn.state.cache['.geno']:
        with zipfile.ZipFile(io.BytesIO(next(iter(zip_file_dropper.value.items()))[1])) as zip_ref:
            with zip_ref.open(geno_file_path) as zip_file:
                for row in zip_file:
                    num_rows += 1
                    num_columns.append(len(row.decode('utf-8').rstrip()))

                    if (num_rows % 1000 == 0):
                        text_lines[-1] = f'Number of rows: {num_rows}'
                        set_alert_pane('\n'.join(text_lines), 'warning')

        text_lines[-1] = f'Number of rows: {num_rows}'
        set_alert_pane('\n'.join(text_lines), 'warning')

        return num_rows, num_columns



    def zip_file_names():
        files = []
        with zipfile.ZipFile(io.BytesIO(next(iter(zip_file_dropper.value.items()))[1])) as zip_ref:
            for file in zip_ref.namelist():
                if zipfile.Path(zip_ref, file).is_file():
                    files.append(file)
        return files



    def unzip_input_file():
        #global input_triad
        #input_triad = {}

        with zipfile.ZipFile(io.BytesIO(next(iter(zip_file_dropper.value.items()))[1])) as zip_ref:
            files = zip_ref.namelist()
            for file in files:
                file_path = Path(file)
                if file_path.suffix in ['.ind', '.snp']:
                    #input_triad[file] = zip_ref.read(file).decode('utf-8').splitlines()
                    pn.state.cache[file_path.suffix] = []
                    with zip_ref.open(file) as zip_file:
                        for row in zip_file:
                            pn.state.cache[file_path.suffix].append(row.decode('utf-8').rstrip())
            #zip_file_dropper.value = {}



    def load_input_files(event):
        file_paths = zip_file_names()

        # Check selected files for invalid suffixes

        invalid_file_suffixes = []

        for fp in file_paths:
            file_path = Path(fp)
            if file_path.suffix not in ['.geno', '.ind', '.snp']:
                invalid_file_suffixes.append(file_path.suffix + '\n')

        if len(invalid_file_suffixes) > 0:
            invalid_suff_list = '- '.join(invalid_file_suffixes)
            text = f'### Unrecognized file suffixes found in ZIP file:\n{invalid_suff_list}\nValid input files end with the suffixes: .geno, .ind and .snp'
            set_alert_pane(text, 'danger')
            return

        # Check for triad

        suffixes = [Path(fp).suffix for fp in file_paths]

        count_geno = suffixes.count('.geno')
        count_ind = suffixes.count('.ind')
        count_snp = suffixes.count('.snp')

        if count_geno != 1 or count_ind != 1 or count_snp != 1:
            text = '### Wrong number of input files\nPlease, upload a triad of input files (.geno, .ind, .snp)'
            set_alert_pane(text, 'danger')
            return

        # Succesful selection

        text = '### Extracting ZIP file to memory\nPlease, wait...'
        set_alert_pane(text, 'warning')

        unzip_input_file()

        global geno_file_path, ind_file_path, snp_file_path

        for fp in file_paths:
            file_path = Path(fp)
            if file_path.suffix == '.geno':
                geno_file_path = fp
            elif file_path.suffix == '.ind':
                ind_file_path = fp
            elif file_path.suffix == '.snp':
                snp_file_path = fp

        # Parsing

        # Check .geno table

        num_geno_rows, num_geno_columns = geno_table_shape()

        if not all(nc == num_geno_columns[0] for nc in num_geno_columns):
            text = f'### Parsing failed\nIn {geno_file_path}: Not all rows are of equal number of columns'
            set_alert_pane(text, 'danger')
            return

        # Parse and check number of alleles and rows

        global num_alleles

        num_alleles = parse_snp_names()

        if num_alleles != num_geno_rows:
            text = f'### Parsing failed\nNumber of alleles ({num_alleles}) in .snp file is not equal to number of rows ({num_geno_rows}) in .geno file'
            set_alert_pane(text, 'danger')
            return

        # Parse and check columns

        num_ind_rows = parse_populations()

        if num_ind_rows != num_geno_columns[0]:
            text = f'### Parsing failed\nNumber of rows ({num_ind_rows}) in .ind file is not equal to number of columns ({num_geno_columns[0]}) in .geno file'
            set_alert_pane(text, 'danger')
            return

        # Parse and check selected populations

        global sel_pops
        global parsed_sel_pops

        dat_file_path = ''

        if dat_file_dropper.value:
            dat_file_data = next(iter(dat_file_dropper.value.items()))[1].decode('utf-8')
            parse_selected_populations(dat_file_data)
            dat_file_path = next(iter(dat_file_dropper.value.items()))[0]
        else:
            sel_pops = []
            parsed_sel_pops = []
            compute_freqs_button.disabled = True

        freqs_download_button.disabled = True

        # Set tables

        set_pops_table_data(populations, avail_pops_table)
        set_pops_table_data(sel_pops, sel_pops_table)

        avail_pops_filter.disabled = False

        text = f'### Parsing successful\nParsed input files seem to have a correct structure:\n- {num_geno_rows} rows and {num_geno_columns[0]} columns in {geno_file_path}\n- {num_alleles} alleles in {snp_file_path}\n- {num_ind_rows} rows and {len(populations_dict)} populations in {ind_file_path}'
        if len(sel_pops) > 0:
            text += f'\n- {len(sel_pops)} selected populations in {dat_file_path}'
        set_alert_pane(text, 'success')



    pn.bind(load_input_files, load_files_button, watch = True)



    def invalid_allele_indices():
        indices = []

        for pop, freqs in allele_frequencies.items():
            for index, freq in enumerate(freqs):
                if freq == -1:
                    indices.append(index)

        global invalid_indices
        invalid_indices = np.unique(np.array(indices, dtype = int))

        global num_valid_alleles
        num_valid_alleles = num_alleles - invalid_indices.size



    def remove_invalid_alleles():
        global allele_frequencies
        for pop, freqs in allele_frequencies.items():
            allele_frequencies[pop] = np.delete(freqs, invalid_indices)



    def time_format(seconds):
        minutes = int(seconds // 60)
        seconds = int(seconds % 60)
        return f'{minutes} minutes, {seconds} seconds'


    def allele_frequency(alleles):
        freq = 0
        num_alleles = 0

        for a in alleles:
            if a != 9:
                freq += (2 - a) / 2
                num_alleles += 1

        if num_alleles == 0:
            return -1

        return freq / num_alleles



    def population_allele_frequencies(pop_indices, allele_freqs):
        for index, row in enumerate(geno_file_data.splitlines()):
            allele_freqs[index] = allele_frequency([int(row[i]) for i in pop_indices])



    def compute_populations_frequencies(event):
        num_pops = len(sel_pops)

        text_lines = ['### Computing']
        text = f'Computing {num_alleles} frequencies per population for {num_pops} populations.'
        text_lines.append(text)
        set_alert_pane('\n'.join(text_lines), 'warning')

        text_lines.append('')

        global allele_frequencies
        allele_frequencies = defaultdict(list)
        for pop in sel_pops:
            allele_frequencies[pop] = np.zeros(num_alleles)

        comp_time = []
        t0 = time()

        #for index, row in enumerate(input_triad[geno_file_path]):
        #for index, row in enumerate(pn.state.cache['.geno']):
        with zipfile.ZipFile(io.BytesIO(next(iter(zip_file_dropper.value.items()))[1])) as zip_ref:
            with zip_ref.open(geno_file_path) as zip_file:
                for index, row in enumerate(zip_file):
                    index += 1
                    row = row.decode('utf-8').rstrip()

                    if index % 1000 == 0 or index == num_alleles:
                        t1 = time()

                    for pop in sel_pops:
                        allele_frequencies[pop][index - 1] = allele_frequency([int(row[i]) for i in populations_dict[pop]])

                    if index % 1000 == 0 or index == num_alleles:
                        t2 = time()

                        comp_time.append(t2 - t1)

                        avg_comp_time = sum(comp_time) / len(comp_time)
                        remaining_comps = num_alleles - index
                        remaining_time = remaining_comps * avg_comp_time

                        percentage_done = index / num_alleles

                        t3 = time()
                        elapsed_time = t3 - t0

                        text_lines[-1] = f'Processed: {index} / {num_alleles} rows ({percentage_done:.1%})\nEstimated remaining time: {time_format(remaining_time)}\nElapsed time {time_format(elapsed_time)}'
                        set_alert_pane('\n'.join(text_lines), 'warning')

        text_lines[0] = '### Finished'
        set_alert_pane('\n'.join(text_lines), 'success')

        invalid_allele_indices()

        if len(invalid_indices) > 0:
            text = f'Number of excluded SNPs: {len(invalid_indices)}'
            text_lines.append(text)
            set_alert_pane('\n'.join(text_lines), 'success')

            remove_invalid_alleles()

        init_selects_options()

        compute_results_button.disabled = False
        resulting_data_output.object = ''

        f4prime_fit_pane.object = None
        f4_fit_pane.object = None
        f4_ratio_histogram_pane.object = None

        freqs_download_button.disabled = False
        results_download_button.disabled = True
        f4_points_download_button.disabled = True




    pn.bind(compute_populations_frequencies, compute_freqs_button, watch = True)



    def mixing_coefficient_pre_jl(hybrid_freqs, parent1_freqs, parent2_freqs):
        parent_diff = parent1_freqs - parent2_freqs
        return np.dot(hybrid_freqs - parent2_freqs, parent_diff) / np.dot(parent_diff, parent_diff)



    def admixture_angle_pre_jl(hybrid_freqs, parent1_freqs, parent2_freqs):
        xa = hybrid_freqs - parent1_freqs
        xb = hybrid_freqs - parent2_freqs

        cosine = np.dot(xa, xb) / np.sqrt(np.dot(xa, xa) * np.dot(xb, xb))
        angle = np.arccos(cosine)
        percentage = angle / np.pi

        return cosine, angle * 180 / np.pi, percentage



    def f3(hybrid_freqs, parent1_freqs, parent2_freqs):
        num_alleles = hybrid_freqs.size
        return np.dot(hybrid_freqs - parent1_freqs, hybrid_freqs - parent2_freqs) / num_alleles



    def f4_prime(hybrid_freqs, parent1_freqs, parent2_freqs, aux_freqs):
        num_aux_pops = len(aux_freqs)
        num_pairs = int(num_aux_pops * (num_aux_pops - 1) / 2)

        f4ab_prime = np.zeros(num_pairs)
        f4xb_prime = np.zeros(num_pairs)

        ab = parent1_freqs - parent2_freqs
        xb = hybrid_freqs - parent2_freqs

        index = 0

        for i in range(num_aux_pops):
            for j in range(i + 1, num_aux_pops):
                ij = aux_freqs[i] - aux_freqs[j]
                norm_ij = np.linalg.norm(ij)
                f4ab_prime[index] = np.dot(ab, ij) / norm_ij
                f4xb_prime[index] = np.dot(xb, ij) / norm_ij
                index += 1

        return f4ab_prime, f4xb_prime



    def f4_std(hybrid_freqs, parent1_freqs, parent2_freqs, aux_freqs):
        num_aux_pops = len(aux_freqs)
        num_pairs = int(num_aux_pops * (num_aux_pops - 1) / 2)

        f4ab_std = np.zeros(num_pairs)
        f4xb_std = np.zeros(num_pairs)

        ab = parent1_freqs - parent2_freqs
        xb = hybrid_freqs - parent2_freqs

        index = 0

        for i in range(num_aux_pops):
            for j in range(i + 1, num_aux_pops):
                ij = aux_freqs[i] - aux_freqs[j]
                f4ab_std[index] = np.dot(ab, ij)
                f4xb_std[index] = np.dot(xb, ij)
                index += 1

        num_alleles = hybrid_freqs.size

        return f4ab_std / num_alleles, f4xb_std / num_alleles



    def least_squares(x, y):
        dim = len(x)

        A = np.vstack([x, np.zeros(dim)]).T
        alpha = np.linalg.lstsq(A, y)[0][0]

        Q = 0
        for i in range(dim):
            Q += (y[i] - alpha * x[i]) ** 2

        x_avg = 0
        for i in range(dim):
            x_avg += x[i]
        x_avg /= dim

        x_dev = 0
        for i in range(dim):
            x_dev += (x[i] - x_avg) ** 2

        s_alpha = np.sqrt(Q / ((dim - 2) * x_dev))
        t = 1.98

        error = s_alpha * t

        return alpha, error



    def admixture_angle_post_jl(hybrid_freqs, parent1_freqs, parent2_freqs, aux_freqs):
        num_aux_pops = len(aux_freqs)
        num_pairs = int(num_aux_pops * (num_aux_pops - 1) / 2)

        xa = hybrid_freqs - parent1_freqs
        xb = hybrid_freqs - parent2_freqs

        sum1 = 0
        sum2 = 0
        sum3 = 0


        for i in range(num_aux_pops):
            for j in range(i + 1, num_aux_pops):
                ij = aux_freqs[i] - aux_freqs[j]

                xaij = np.dot(xa, ij)
                xbij = np.dot(xb, ij)
                ijij = np.dot(ij, ij)

                sum1 += xaij * xbij / ijij
                sum2 += (xaij ** 2) / ijij
                sum3 += (xbij ** 2) / ijij

        cosine = sum1 / np.sqrt(sum2 * sum3)
        angle = np.arccos(cosine)
        percentage = angle / np.pi

        return cosine, angle * 180 / np.pi, percentage



    def f4_ratio(hybrid_freqs, parent1_freqs, parent2_freqs, aux_freqs):
        num_aux_pops = len(aux_freqs)
        num_pairs = int(num_aux_pops * (num_aux_pops - 1) / 2)

        xb = hybrid_freqs - parent2_freqs
        ab = parent1_freqs - parent2_freqs

        alpha = np.zeros(num_pairs)

        index = 0

        for i in range(num_aux_pops):
            for j in range(i + 1, num_aux_pops):
                ij = aux_freqs[i] - aux_freqs[j]
                alpha[index] = np.dot(xb, ij) / np.dot(ab, ij)
                index += 1

        alpha_01 = alpha[(alpha >= 0) & (alpha <= 1)]
        alpha_avg = np.average(alpha_01)
        alpha_std_dev = np.std(alpha_01) * 1.96
        alpha_hist = np.histogram(alpha, 20)

        return alpha, alpha_avg, alpha_std_dev, alpha_hist, alpha_01.size



    def plot_fit(x, y, alpha, title, xlabel, ylabel):
        fig = Figure(figsize = (plot_width_input.value, plot_height_input.value), layout = 'constrained')
        ax = fig.subplots()

        ax.set_title(title, fontsize = plot_title_size_input.value)

        ax.set_xlabel(xlabel, fontsize = plot_label_size_input.value)
        ax.set_ylabel(ylabel, fontsize = plot_label_size_input.value)

        ax.plot(x, y, '.')
        ax.plot(x, alpha * x)

        return fig



    def plot_histogram(histogram, title, xlabel, ylabel):
        counts = histogram[0]
        edges = histogram[1]

        fig = Figure(figsize = (plot_width_input.value, plot_height_input.value), layout = 'constrained')
        ax = fig.subplots()

        ax.set_title(title, fontsize = plot_title_size_input.value)

        ax.set_xlabel(xlabel, fontsize = plot_label_size_input.value)
        ax.set_ylabel(ylabel, fontsize = plot_label_size_input.value)

        ax.bar(edges[:-1], counts, width = np.diff(edges), edgecolor = 'black', align = 'edge')

        return fig



    def plot_results(event):
        global f4ab_prime, f4xb_prime, alpha, f4ab_std, f4xb_std, alpha_std, alpha_ratio_hist

        if all([el is not None for el in [f4ab_prime, f4xb_prime, alpha, f4ab_std, f4xb_std, alpha_std, alpha_ratio_hist]]):
            f4prime_fit_fig = plot_fit(f4ab_prime, f4xb_prime, alpha, f'{hybrid} = alpha {parent1} + (1 - alpha) {parent2}', f"f4'({parent1}, {parent2}; i, j)", f"f4'({hybrid}, {parent2}; i, j)")
            f4_fit_fig = plot_fit(f4ab_std, f4xb_std, alpha_std, f'{hybrid} = alpha {parent1} + (1 - alpha) {parent2}', f"f4({parent1}, {parent2}; i, j)", f"f4({hybrid}, {parent2}; i, j)")
            f4_ratio_histogram_fig = plot_histogram(alpha_ratio_hist, f'{hybrid} = alpha {parent1} + (1 - alpha) {parent2}', 'f4 ratio', 'Counts')

            f4prime_fit_pane.object = f4prime_fit_fig
            f4_fit_pane.object = f4_fit_fig
            f4_ratio_histogram_pane.object = f4_ratio_histogram_fig



    plot_width_input.param.watch(plot_results, 'value')
    plot_height_input.param.watch(plot_results, 'value')
    plot_title_size_input.param.watch(plot_results, 'value')
    plot_label_size_input.param.watch(plot_results, 'value')



    def compute_results(event):
        global alpha_pre_jl, cosine_pre_jl, angle_pre_jl, percentage_pre_jl, f3_test
        global f4ab_prime, f4xb_prime, alpha, alpha_error
        global f4ab_std, f4xb_std, alpha_std, alpha_std_error
        global cosine_post_jl, angle_post_jl, percentage_post_jl
        global alpha_ratio, alpha_ratio_avg, alpha_ratio_std_dev, alpha_ratio_hist, num_cases

        hybrid_freqs = allele_frequencies[hybrid]
        parent1_freqs = allele_frequencies[parent1]
        parent2_freqs = allele_frequencies[parent2]
        aux_freqs = [allele_frequencies[pop] for pop in auxiliaries]

        alpha_pre_jl = mixing_coefficient_pre_jl(hybrid_freqs, parent1_freqs, parent2_freqs)

        cosine_pre_jl, angle_pre_jl, percentage_pre_jl = admixture_angle_pre_jl(hybrid_freqs, parent1_freqs, parent2_freqs)

        f3_test = f3(hybrid_freqs, parent1_freqs, parent2_freqs)

        f4ab_prime, f4xb_prime = f4_prime(hybrid_freqs, parent1_freqs, parent2_freqs, aux_freqs)
        alpha, alpha_error = least_squares(f4ab_prime, f4xb_prime)

        f4ab_std, f4xb_std = f4_std(hybrid_freqs, parent1_freqs, parent2_freqs, aux_freqs)
        alpha_std, alpha_std_error = least_squares(f4ab_std, f4xb_std)

        cosine_post_jl, angle_post_jl, percentage_post_jl = admixture_angle_post_jl(hybrid_freqs, parent1_freqs, parent2_freqs, aux_freqs)

        alpha_ratio, alpha_ratio_avg, alpha_ratio_std_dev, alpha_ratio_hist, num_cases = f4_ratio(hybrid_freqs, parent1_freqs, parent2_freqs, aux_freqs)

        # Output

        num_aux_pops = len(auxiliaries)
        num_aux_pairs = int(num_aux_pops * (num_aux_pops - 1) / 2)

        text = '### Admixture model\n'
        text += f'`{hybrid} = {parent1} + {parent2}`\n'
        text += f'SNPs employed: {num_valid_alleles} / {num_alleles}\n'
        text += f'Auxiliary populations: {num_aux_pops}\n'
        text += f'Auxiliary pairs: {num_aux_pairs}\n'
        text += '### Admixture angle\n'
        text += '| Calculation | Cosine | Angle (deg) | Percentage of 180 deg |\n'
        text += '| --- | --- | --- | --- |\n'
        text += f'| Pre-JL | {cosine_pre_jl:7.4f} | {angle_pre_jl:7.2f} | {percentage_pre_jl:.1%} |\n'
        text += f'| Post-JL | {cosine_post_jl:7.4f} | {angle_post_jl:7.2f} | {percentage_post_jl:.1%} |\n'
        text += '### Mixing coefficient\n'
        text += '| Calculation | Alpha | Error (95% CI) |\n'
        text += '| --- | --- | --- |\n'
        text += f'| Pre-JL | {alpha_pre_jl:6.4f} | - |\n'
        text += f'| Post-JL (f4-prime, renormalized) | {alpha:6.4f} | {alpha_error:6.4f} |\n'
        text += f'| Post-JL NR (f4, standard) | {alpha_std:6.4f} | {alpha_std_error:6.4f} |\n'
        text += '### f4-ratio and f3 test\n'
        text += f'f4-ratio average if [0, 1]: {alpha_ratio_avg:6.4f} +/- {alpha_ratio_std_dev:6.4f} (95% CI), {num_cases} cases\n'
        text += f'Standard admixture test: f3(c1, c2; x) < 0 ? {f3_test:8.6f}'

        resulting_data_output.object = text

        plot_results(None)

        results_download_button.disabled = False
        f4_points_download_button.disabled = False



    pn.bind(compute_results, compute_results_button, watch = True)



    def save_population_allele_frequencies():
        file = io.StringIO()

        pops_width = max([len(name) for name in sel_pops])
        prec = 6
        col_width = max(prec + 7, pops_width)

        headers_format = ' '.join([f'{{{i}:^{col_width}}}' for i, pop in enumerate(sel_pops)])
        headers = headers_format.format(*sel_pops)
        file.write(headers + '\n')

        row_format = ' '.join([f'{{{i}: {col_width}.{prec}E}}' for i, pop in enumerate(sel_pops)])

        for allele_index in range(num_valid_alleles):
            row = [freqs[allele_index] for pop, freqs in allele_frequencies.items()]
            file.write(row_format.format(*row) + '\n')

        file.seek(0)

        now = datetime.now()
        name = now.strftime("frequencies_%Y-%m-%d_%Hh%Mm%Ss")
        freqs_download_button.filename = name + '.dat'

        return file



    freqs_download_button.callback = save_population_allele_frequencies



    def save_f4_points():
        file = io.StringIO()

        aux_pops_width = max([len(name) for name in auxiliaries])
        prec = 6
        col_width = prec + 7

        headers = '{0:^{col_width}} {1:^{col_width}} {2:^{col_width}} {3:^{col_width}} {4:^{col_width}} {5:^{aux_pops_width}} {6:^{aux_pops_width}}'.format('f4primeAB', 'f4primeXB', 'f4AB', 'f4XB', 'f4-ratio', 'Aux1', 'Aux2', col_width = col_width, aux_pops_width = aux_pops_width)
        file.write(headers + '\n')

        num_aux_pops = len(sel_pops[3:])

        index = 0

        for i in range(num_aux_pops):
            for j in range(i + 1, num_aux_pops):
                row = '{0: {col_width}.{prec}E} {1: {col_width}.{prec}E} {2: {col_width}.{prec}E} {3: {col_width}.{prec}E} {4: {col_width}.{prec}E} {5:{aux_pops_width}} {6:{aux_pops_width}}'.format(f4ab_prime[index], f4xb_prime[index], f4ab_std[index], f4xb_std[index], alpha_ratio[index], auxiliaries[i], auxiliaries[j], prec = prec, col_width = col_width, aux_pops_width = aux_pops_width)
                file.write(row + '\n')
                index += 1

        file.seek(0)

        now = datetime.now()
        name = now.strftime("f4_points_%Y-%m-%d_%Hh%Mm%Ss")
        f4_points_download_button.filename = name + '.dat'

        return file



    f4_points_download_button.callback = save_f4_points



    def save_admixture_data():
        num_aux_pops = len(auxiliaries)
        num_aux_pairs = int(num_aux_pops * (num_aux_pops - 1) / 2)

        file = io.StringIO()

        file.write(f'Admixture model: {hybrid} = {parent1} + {parent2}\n')
        file.write(f'SNPs employed: {num_valid_alleles} / {num_alleles}\n')
        file.write(f'Auxiliary populations: {num_aux_pops}\n')
        file.write(f'Auxiliary pairs: {num_aux_pairs}\n')
        file.write(f'Cos pre-JL:  {cosine_pre_jl:7.4f} ---> Angle pre-JL:  {angle_pre_jl:7.2f} deg vs 180 deg: {percentage_pre_jl:.1%}\n')
        file.write(f'Cos post-JL: {cosine_post_jl:7.4f} ---> Angle post-JL: {angle_post_jl:7.2f} deg vs 180 deg: {percentage_post_jl:.1%}\n')
        file.write(f'Alpha pre-JL:     {alpha_pre_jl:6.4f}\n')
        file.write(f'Alpha post-JL:    {alpha:6.4f} +/- {alpha_error:6.4f} (95% CI) (f4-prime, renormalized)\n')
        file.write(f'Alpha NR post-JL: {alpha_std:6.4f} +/- {alpha_std_error:6.4f} (95% CI) (f4, standard)\n')
        file.write(f'f4-ratio average if [0, 1]: {alpha_ratio_avg:6.4f} +/- {alpha_ratio_std_dev:6.4f} (95% CI), {num_cases} cases\n')
        file.write(f'Standard admixture test: f3(c1, c2; x) < 0 ? {f3_test:8.6f}')

        file.seek(0)

        now = datetime.now()
        name = now.strftime("results_%Y-%m-%d_%Hh%Mm%Ss")
        results_download_button.filename = name + '.dat'

        return file



    results_download_button.callback = save_admixture_data



    def admixture_model_card_width():
        return hybrid_select.width + 2 * hybrid_select.margin[1] + parent1_select.width + 2 * parent1_select.margin[1] + parent2_select.width + 2 * parent2_select.margin[1] + aux_pops_select.width + 2 * aux_pops_select.margin[1]

    def admixture_model_card_height():
        print(hybrid_select.height)
        return hybrid_select.height + 2 * hybrid_select.margin[0]



    # Cards and their layouts

    card_margin = 10

    alert_card = pn.Card(alert_pane, title = 'Messages', collapsible = True, margin = card_margin)

    zip_file_dropper_card = pn.Card(zip_file_dropper, title = 'Upload ZIP with input triad', collapsible = False, margin = card_margin, styles = {'width': 'fit-content'})
    dat_file_dropper_card = pn.Card(dat_file_dropper, title = 'Upload file with selected populations', collapsible = False, margin = card_margin, styles = {'width': 'fit-content'})
    input_droppers_layout = pn.FlexBox(zip_file_dropper_card, dat_file_dropper_card, flex_direction = 'row')

    avail_pops_card = pn.Card(avail_pops_filter, avail_pops_table, title = 'Available populations', margin = card_margin, styles = {'width': 'fit-content'})
    sel_pops_card = pn.Card(reset_sel_pops_button, sel_pops_table, title = 'Selected populations', margin = card_margin, styles = {'width': 'fit-content'})
    comp_card = pn.Card(compute_freqs_button, freqs_download_button, title = 'Actions', margin = card_margin, styles = {'width': 'fit-content'})

    admixture_model_layout = pn.FlexBox(hybrid_select, parent1_select, parent2_select, aux_pops_select, flex_direction = 'row', justify_content = 'space-evenly')
    admixture_model_card = pn.Card(admixture_model_layout, title = 'Admixture model', collapsible = False, margin = card_margin, styles = {'width': 'fit-content'})

    actions_card = pn.Card(compute_results_button, f4_points_download_button, results_download_button, title = 'Actions', collapsible = False, margin = card_margin, styles = {'width': 'fit-content'})
    plot_options_card = pn.Card(plot_width_input, plot_height_input, plot_title_size_input, plot_label_size_input, title = 'Plot options', collapsible = False, margin = card_margin, styles = {'width': 'fit-content'})
    resulting_data_card = pn.Card(resulting_data_output, title = 'Results', collapsible = False, margin = card_margin, styles = {'width': 'fit-content'})

    plots_layout = pn.FlexBox(f4prime_fit_pane, f4_fit_pane, f4_ratio_histogram_pane, flex_direction = 'row', justify_content = 'space-evenly')
    plots_card = pn.Card(plots_layout, title = 'Plots', collapsible = False, margin = card_margin, styles = {'width': 'fit-content'})

    # Layouts


    input_files_layout = pn.Column(input_droppers_layout, load_files_button, name = 'Inputs', sizing_mode = 'stretch_width', styles = {'width': 'fit-content'})
    select_pops_layout = pn.FlexBox(avail_pops_card, sel_pops_card, comp_card, name = 'Select populations', flex_direction = 'row', styles = {'width': 'fit-content'})
    results_layout = pn.FlexBox(admixture_model_card, actions_card, plot_options_card, resulting_data_card, plots_card, name = 'Results', flex_direction = 'row', justify_content = 'space-evenly', styles = {'width': 'fit-content'})

    # Tabs

    tabs = pn.Tabs(input_files_layout, select_pops_layout, results_layout)

    # Main layout

    main_layout = pn.Column(alert_card, tabs, scroll = True)

    # Template

    template = pn.template.VanillaTemplate(title = 'Mixtum: The geometry of admixture in population genetics')
    template.main.append(main_layout)
    template.servable()


    asyncio.ensure_future(write_doc());</script>
    <script type="application/json" id="p1125">
      {"b32efed9-5005-4348-a56d-32d9de9f40c6":{"version":"3.5.1","title":"Mixtum: The geometry of admixture in population genetics","roots":[{"type":"object","name":"panel.models.location.Location","id":"p1002","attributes":{"name":"location","reload":false}},{"type":"object","name":"panel.models.markup.HTML","id":"p1008","attributes":{"name":"js_area","stylesheets":["\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"type":"object","name":"ImportedStyleSheet","id":"p1006","attributes":{"url":"https://cdn.holoviz.org/panel/1.5.0-b.3/dist/css/loading.css"}},{"type":"object","name":"ImportedStyleSheet","id":"p1005","attributes":{"url":"https://cdn.holoviz.org/panel/1.5.0-b.3/dist/bundled/theme/native.css"}}],"width":0,"height":0,"margin":0,"sizing_mode":"fixed","align":"start","disable_math":true}},{"type":"object","name":"panel.models.reactive_html.ReactiveHTML","id":"p1010","attributes":{"name":"actions","subscribed_events":{"type":"set","entries":["dom_event"]},"stylesheets":["\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1006"},{"id":"p1005"}],"margin":0,"align":"start","data":{"type":"object","name":"TemplateActions1","id":"p1009","attributes":{"name":"TemplateActions00208"}},"scripts":{"type":"map","entries":[["open_modal",["document.getElementById(&amp;#x27;pn-Modal&amp;#x27;).style.display = &amp;#x27;block&amp;#x27;\nwindow.dispatchEvent(new Event(&amp;#x27;resize&amp;#x27;));"]],["close_modal",["document.getElementById(&amp;#x27;pn-Modal&amp;#x27;).style.display = &amp;#x27;none&amp;#x27;"]]]}}},{"type":"object","name":"panel.models.browser.BrowserInfo","id":"p1011","attributes":{"name":"browser_info"}},{"type":"object","name":"panel.models.markup.HTML","id":"p1013","attributes":{"name":"busy_indicator","css_classes":["loader","light"],"stylesheets":[":host { --loading-spinner-size: 20px; }","\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1006"},{"type":"object","name":"ImportedStyleSheet","id":"p1012","attributes":{"url":"https://cdn.holoviz.org/panel/1.5.0-b.3/dist/css/loadingspinner.css"}},{"id":"p1005"}],"min_width":20,"min_height":20,"margin":[5,10],"align":"start"}},{"type":"object","name":"panel.models.layout.Column","id":"p1014","attributes":{"name":"main-134436030144512","tags":["main"],"css_classes":["scrollable-vertical"],"stylesheets":["\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1006"},{"type":"object","name":"ImportedStyleSheet","id":"p1007","attributes":{"url":"https://cdn.holoviz.org/panel/1.5.0-b.3/dist/css/listpanel.css"}},{"id":"p1005"}],"margin":0,"sizing_mode":"stretch_width","align":"start","children":[{"type":"object","name":"panel.models.layout.Card","id":"p1015","attributes":{"name":"Card00150","css_classes":["card"],"stylesheets":["\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1006"},{"id":"p1007"},{"id":"p1005"}],"margin":10,"sizing_mode":"stretch_width","align":"start","children":[{"type":"object","name":"Row","id":"p1018","attributes":{"name":"Row00149","css_classes":["card-header-row"],"stylesheets":["\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1006"},{"id":"p1007"},{"id":"p1005"}],"margin":0,"sizing_mode":"stretch_width","align":"start","children":[{"type":"object","name":"panel.models.markup.HTML","id":"p1019","attributes":{"css_classes":["card-title"],"stylesheets":["\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1006"},{"id":"p1005"}],"margin":[5,0],"align":"start","text":"&amp;lt;h3&amp;gt;Messages&amp;lt;/h3&amp;gt;","disable_math":true}}]}},{"type":"object","name":"panel.models.markup.HTML","id":"p1017","attributes":{"css_classes":["markdown","alert","alert-primary"],"stylesheets":["\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1006"},{"type":"object","name":"ImportedStyleSheet","id":"p1016","attributes":{"url":"https://cdn.holoviz.org/panel/1.5.0-b.3/dist/css/alerts.css"}},{"id":"p1005"}],"margin":[5,10],"sizing_mode":"stretch_width","align":"start","text":"&amp;lt;h3&amp;gt;Input files upload&amp;lt;/h3&amp;gt;\n&amp;lt;p&amp;gt;Please, upload a ZIP with a triad of .geno, .ind and .snp input files, and optionally an input file with a list of selected populations.&amp;lt;br /&amp;gt;\nThen press the parse button.&amp;lt;/p&amp;gt;\n"}}],"active_header_background":"","button_css_classes":["card-button"],"collapsed":false,"header_background":"","header_color":"","header_css_classes":["card-header"]}},{"type":"object","name":"panel.models.tabs.Tabs","id":"p1020","attributes":{"stylesheets":["\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1006"},{"id":"p1005"}],"margin":0,"sizing_mode":"stretch_width","align":"start","tabs":[{"type":"object","name":"TabPanel","id":"p1040","attributes":{"name":"Inputs","title":"Inputs","child":{"type":"object","name":"panel.models.layout.Column","id":"p1021","attributes":{"name":"Inputs","styles":{"type":"map","entries":[["width","fit-content"]]},"stylesheets":["\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1006"},{"id":"p1007"},{"id":"p1005"}],"margin":0,"sizing_mode":"stretch_width","align":"start","children":[{"type":"object","name":"panel.models.reactive_html.ReactiveHTML","id":"p1023","attributes":{"subscribed_events":{"type":"set","entries":["dom_event"]},"stylesheets":["\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1006"},{"id":"p1005"}],"margin":0,"sizing_mode":"stretch_width","align":"start","attrs":{"type":"map","entries":[["flexbox",[["style",["flex_wrap","justify_content","flex_direction","align_content","align_items","gap"],"display: flex; flex-wrap: {flex_wrap}; justify-content: {justify_content}; flex-direction: {flex_direction}; align-content: {align_content}; align-items: {align_items}; gap: {gap}; height: 100%;"]]]]},"children":{"type":"map","entries":[["flex-item",[{"type":"object","name":"panel.models.layout.Card","id":"p1024","attributes":{"name":"Card00154","css_classes":["card"],"styles":{"type":"map","entries":[["width","fit-content"]]},"stylesheets":["\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1006"},{"id":"p1007"},{"id":"p1005"}],"margin":10,"align":"start","children":[{"type":"object","name":"Row","id":"p1029","attributes":{"name":"Row00153","css_classes":["card-header-row"],"stylesheets":["\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1006"},{"id":"p1007"},{"id":"p1005"}],"margin":0,"sizing_mode":"stretch_width","align":"start","children":[{"type":"object","name":"panel.models.markup.HTML","id":"p1030","attributes":{"css_classes":["card-title"],"stylesheets":["\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1006"},{"id":"p1005"}],"margin":[5,0],"align":"start","text":"&amp;lt;h3&amp;gt;Upload ZIP with input triad&amp;lt;/h3&amp;gt;","disable_math":true}}]}},{"type":"object","name":"panel.models.file_dropper.FileDropper","id":"p1028","attributes":{"subscribed_events":{"type":"set","entries":["upload_event","delete_event"]},"stylesheets":[{"type":"object","name":"ImportedStyleSheet","id":"p1109","attributes":{"url":"https://cdn.holoviz.org/panel/1.5.0-b.3/dist/bundled/filedropper/filepond@^4/dist/filepond.css"}},{"type":"object","name":"ImportedStyleSheet","id":"p1110","attributes":{"url":"https://cdn.holoviz.org/panel/1.5.0-b.3/dist/bundled/filedropper/filepond-plugin-image-preview/dist/filepond-plugin-image-preview.css"}},{"type":"object","name":"ImportedStyleSheet","id":"p1111","attributes":{"url":"https://cdn.holoviz.org/panel/1.5.0-b.3/dist/bundled/filedropper/filepond-plugin-pdf-preview/dist/filepond-plugin-pdf-preview.css"}},"\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1006"},{"id":"p1005"}],"width":300,"min_width":300,"margin":[5,10],"align":"start","accepted_filetypes":["application/zip"],"max_file_size":"1000MB","multiple":false}}],"active_header_background":"","button_css_classes":["card-button"],"collapsed":false,"collapsible":false,"header_background":"","header_color":"","header_css_classes":["card-header"]}},{"type":"object","name":"panel.models.layout.Card","id":"p1031","attributes":{"name":"Card00158","css_classes":["card"],"styles":{"type":"map","entries":[["width","fit-content"]]},"stylesheets":["\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1006"},{"id":"p1007"},{"id":"p1005"}],"margin":10,"align":"start","children":[{"type":"object","name":"Row","id":"p1036","attributes":{"name":"Row00157","css_classes":["card-header-row"],"stylesheets":["\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1006"},{"id":"p1007"},{"id":"p1005"}],"margin":0,"sizing_mode":"stretch_width","align":"start","children":[{"type":"object","name":"panel.models.markup.HTML","id":"p1037","attributes":{"css_classes":["card-title"],"stylesheets":["\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1006"},{"id":"p1005"}],"margin":[5,0],"align":"start","text":"&amp;lt;h3&amp;gt;Upload file with selected populations&amp;lt;/h3&amp;gt;","disable_math":true}}]}},{"type":"object","name":"panel.models.file_dropper.FileDropper","id":"p1035","attributes":{"subscribed_events":{"type":"set","entries":["upload_event","delete_event"]},"stylesheets":[{"type":"object","name":"ImportedStyleSheet","id":"p1112","attributes":{"url":"https://cdn.holoviz.org/panel/1.5.0-b.3/dist/bundled/filedropper/filepond@^4/dist/filepond.css"}},{"type":"object","name":"ImportedStyleSheet","id":"p1113","attributes":{"url":"https://cdn.holoviz.org/panel/1.5.0-b.3/dist/bundled/filedropper/filepond-plugin-image-preview/dist/filepond-plugin-image-preview.css"}},{"type":"object","name":"ImportedStyleSheet","id":"p1114","attributes":{"url":"https://cdn.holoviz.org/panel/1.5.0-b.3/dist/bundled/filedropper/filepond-plugin-pdf-preview/dist/filepond-plugin-pdf-preview.css"}},"\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1006"},{"id":"p1005"}],"width":300,"min_width":300,"margin":[5,10],"align":"start","max_file_size":"1MB","multiple":false}}],"active_header_background":"","button_css_classes":["card-button"],"collapsed":false,"collapsible":false,"header_background":"","header_color":"","header_css_classes":["card-header"]}}]]]},"data":{"type":"object","name":"FlexBox1","id":"p1022","attributes":{"name":"FlexBox00161"}},"html":"&amp;lt;div id=&amp;quot;flexbox-${id}&amp;quot; style=&amp;quot;display: flex; flex-wrap: ${flex_wrap}; justify-content: ${justify_content}; flex-direction: ${flex_direction}; align-content: ${align_content}; align-items: ${align_items}; gap: ${gap}; height: 100%;&amp;quot;&amp;gt;\n\n  &amp;lt;div id=&amp;quot;flex-item-0-${id}&amp;quot; style=&amp;quot;display: contents;&amp;quot;&amp;gt;\n\n  &amp;lt;/div&amp;gt;\n\n  &amp;lt;div id=&amp;quot;flex-item-1-${id}&amp;quot; style=&amp;quot;display: contents;&amp;quot;&amp;gt;\n\n  &amp;lt;/div&amp;gt;\n\n&amp;lt;/div&amp;gt;","looped":["flex-item"],"nodes":["flexbox","flex-item-0","flex-item-1"]}},{"type":"object","name":"panel.models.widgets.Button","id":"p1039","attributes":{"button_type":"primary","subscribed_events":{"type":"set","entries":["button_click"]},"css_classes":["solid"],"stylesheets":["\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1006"},{"type":"object","name":"ImportedStyleSheet","id":"p1038","attributes":{"url":"https://cdn.holoviz.org/panel/1.5.0-b.3/dist/css/button.css"}},{"id":"p1005"}],"margin":[5,10],"align":"start","label":"Parse and check input files"}}]}}}},{"type":"object","name":"TabPanel","id":"p1067","attributes":{"name":"Select populations","title":"Select populations","child":{"type":"object","name":"panel.models.reactive_html.ReactiveHTML","id":"p1042","attributes":{"subscribed_events":{"type":"set","entries":["dom_event"]},"styles":{"type":"map","entries":[["width","fit-content"]]},"stylesheets":["\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1006"},{"id":"p1005"}],"margin":0,"sizing_mode":"stretch_width","align":"start","attrs":{"type":"map","entries":[["flexbox",[["style",["flex_wrap","justify_content","flex_direction","align_content","align_items","gap"],"display: flex; flex-wrap: {flex_wrap}; justify-content: {justify_content}; flex-direction: {flex_direction}; align-content: {align_content}; align-items: {align_items}; gap: {gap}; height: 100%;"]]]]},"children":{"type":"map","entries":[["flex-item",[{"type":"object","name":"panel.models.layout.Card","id":"p1043","attributes":{"name":"Card00163","css_classes":["card"],"styles":{"type":"map","entries":[["width","fit-content"]]},"stylesheets":["\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1006"},{"id":"p1007"},{"id":"p1005"}],"margin":10,"align":"start","children":[{"type":"object","name":"Row","id":"p1051","attributes":{"name":"Row00162","css_classes":["card-header-row"],"stylesheets":["\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1006"},{"id":"p1007"},{"id":"p1005"}],"margin":0,"sizing_mode":"stretch_width","align":"start","children":[{"type":"object","name":"panel.models.markup.HTML","id":"p1052","attributes":{"css_classes":["card-title"],"stylesheets":["\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1006"},{"id":"p1005"}],"margin":[5,0],"align":"start","text":"&amp;lt;h3&amp;gt;Available populations&amp;lt;/h3&amp;gt;","disable_math":true}}]}},{"type":"object","name":"panel.models.widgets.TextInput","id":"p1044","attributes":{"subscribed_events":{"type":"set","entries":["enter-pressed"]},"stylesheets":["\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1006"},{"id":"p1005"}],"disabled":true,"width":300,"min_width":300,"margin":[5,10],"align":"start","title":"Search populations:","placeholder":"Enter population name","max_length":5000}},{"type":"object","name":"panel.models.tabulator.DataTabulator","id":"p1050","attributes":{"subscribed_events":{"type":"set","entries":["selection-change","table-edit","cell-click"]},"stylesheets":["\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1006"},{"type":"object","name":"ImportedStyleSheet","id":"p1046","attributes":{"url":"https://cdn.holoviz.org/panel/1.5.0-b.3/dist/bundled/font-awesome/css/all.min.css"}},{"id":"p1005"},{"type":"object","name":"ImportedStyleSheet","id":"p1115","attributes":{"url":"https://cdn.holoviz.org/panel/1.5.0-b.3/dist/bundled/datatabulator/tabulator-tables@6.2.1/dist/css/tabulator_simple.min.css"}}],"margin":[5,10],"align":"start","configuration":{"type":"map","entries":[["selectable",false],["columns",[]],["dataTree",false]]},"editable":false,"layout":"fit_data_table","source":{"type":"object","name":"ColumnDataSource","id":"p1047","attributes":{"selected":{"type":"object","name":"Selection","id":"p1048","attributes":{"indices":[],"line_indices":[]}},"selection_policy":{"type":"object","name":"UnionRenderers","id":"p1049"},"data":{"type":"map"}}},"pagination":"local","page":1,"page_size":10,"max_page":1,"select_mode":false,"selectable_rows":null}}],"active_header_background":"","button_css_classes":["card-button"],"collapsed":false,"header_background":"","header_color":"","header_css_classes":["card-header"]}},{"type":"object","name":"panel.models.layout.Card","id":"p1053","attributes":{"name":"Card00167","css_classes":["card"],"styles":{"type":"map","entries":[["width","fit-content"]]},"stylesheets":["\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1006"},{"id":"p1007"},{"id":"p1005"}],"margin":10,"align":"start","children":[{"type":"object","name":"Row","id":"p1060","attributes":{"name":"Row00166","css_classes":["card-header-row"],"stylesheets":["\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1006"},{"id":"p1007"},{"id":"p1005"}],"margin":0,"sizing_mode":"stretch_width","align":"start","children":[{"type":"object","name":"panel.models.markup.HTML","id":"p1061","attributes":{"css_classes":["card-title"],"stylesheets":["\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1006"},{"id":"p1005"}],"margin":[5,0],"align":"start","text":"&amp;lt;h3&amp;gt;Selected populations&amp;lt;/h3&amp;gt;","disable_math":true}}]}},{"type":"object","name":"panel.models.widgets.Button","id":"p1054","attributes":{"button_type":"primary","subscribed_events":{"type":"set","entries":["button_click"]},"css_classes":["solid"],"stylesheets":["\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1006"},{"id":"p1038"},{"id":"p1005"}],"margin":[5,10],"align":"start","label":"Reset selected populations"}},{"type":"object","name":"panel.models.tabulator.DataTabulator","id":"p1059","attributes":{"subscribed_events":{"type":"set","entries":["selection-change","table-edit","cell-click"]},"stylesheets":["\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1006"},{"id":"p1046"},{"id":"p1005"},{"type":"object","name":"ImportedStyleSheet","id":"p1116","attributes":{"url":"https://cdn.holoviz.org/panel/1.5.0-b.3/dist/bundled/datatabulator/tabulator-tables@6.2.1/dist/css/tabulator_simple.min.css"}}],"margin":[5,10],"align":"start","buttons":{"type":"map","entries":[["remove","&lt;i class='fa fa-times'&gt;&lt;/i&gt;"]]},"configuration":{"type":"map","entries":[["selectable",false],["columns",[]],["dataTree",false]]},"editable":false,"layout":"fit_data_table","source":{"type":"object","name":"ColumnDataSource","id":"p1056","attributes":{"selected":{"type":"object","name":"Selection","id":"p1057","attributes":{"indices":[],"line_indices":[]}},"selection_policy":{"type":"object","name":"UnionRenderers","id":"p1058"},"data":{"type":"map"}}},"pagination":"local","page":1,"page_size":10,"max_page":1,"select_mode":false,"selectable_rows":null}}],"active_header_background":"","button_css_classes":["card-button"],"collapsed":false,"header_background":"","header_color":"","header_css_classes":["card-header"]}},{"type":"object","name":"panel.models.layout.Card","id":"p1062","attributes":{"name":"Card00171","css_classes":["card"],"styles":{"type":"map","entries":[["width","fit-content"]]},"stylesheets":["\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1006"},{"id":"p1007"},{"id":"p1005"}],"margin":10,"align":"start","children":[{"type":"object","name":"Row","id":"p1065","attributes":{"name":"Row00170","css_classes":["card-header-row"],"stylesheets":["\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1006"},{"id":"p1007"},{"id":"p1005"}],"margin":0,"sizing_mode":"stretch_width","align":"start","children":[{"type":"object","name":"panel.models.markup.HTML","id":"p1066","attributes":{"css_classes":["card-title"],"stylesheets":["\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1006"},{"id":"p1005"}],"margin":[5,0],"align":"start","text":"&amp;lt;h3&amp;gt;Actions&amp;lt;/h3&amp;gt;","disable_math":true}}]}},{"type":"object","name":"panel.models.widgets.Button","id":"p1063","attributes":{"button_type":"primary","subscribed_events":{"type":"set","entries":["button_click"]},"css_classes":["solid"],"stylesheets":["\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1006"},{"id":"p1038"},{"id":"p1005"}],"disabled":true,"margin":[5,10],"align":"start","label":"Compute allele frequencies"}},{"type":"object","name":"panel.models.widgets.FileDownload","id":"p1064","attributes":{"css_classes":["solid"],"stylesheets":["\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1006"},{"id":"p1038"},{"id":"p1005"}],"disabled":true,"margin":[5,10],"align":"start","auto":true,"button_type":"primary","label":"Download allele frequencies"}}],"active_header_background":"","button_css_classes":["card-button"],"collapsed":false,"header_background":"","header_color":"","header_css_classes":["card-header"]}}]]]},"data":{"type":"object","name":"FlexBox1","id":"p1041","attributes":{"name":"Select populations"}},"html":"&amp;lt;div id=&amp;quot;flexbox-${id}&amp;quot; style=&amp;quot;display: flex; flex-wrap: ${flex_wrap}; justify-content: ${justify_content}; flex-direction: ${flex_direction}; align-content: ${align_content}; align-items: ${align_items}; gap: ${gap}; height: 100%;&amp;quot;&amp;gt;\n\n  &amp;lt;div id=&amp;quot;flex-item-0-${id}&amp;quot; style=&amp;quot;display: contents;&amp;quot;&amp;gt;\n\n  &amp;lt;/div&amp;gt;\n\n  &amp;lt;div id=&amp;quot;flex-item-1-${id}&amp;quot; style=&amp;quot;display: contents;&amp;quot;&amp;gt;\n\n  &amp;lt;/div&amp;gt;\n\n  &amp;lt;div id=&amp;quot;flex-item-2-${id}&amp;quot; style=&amp;quot;display: contents;&amp;quot;&amp;gt;\n\n  &amp;lt;/div&amp;gt;\n\n&amp;lt;/div&amp;gt;","looped":["flex-item"],"nodes":["flexbox","flex-item-0","flex-item-1","flex-item-2"]}}}},{"type":"object","name":"TabPanel","id":"p1106","attributes":{"name":"Results","title":"Results","child":{"type":"object","name":"panel.models.reactive_html.ReactiveHTML","id":"p1069","attributes":{"subscribed_events":{"type":"set","entries":["dom_event"]},"styles":{"type":"map","entries":[["width","fit-content"]]},"stylesheets":["\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1006"},{"id":"p1005"}],"margin":0,"sizing_mode":"stretch_width","align":"start","attrs":{"type":"map","entries":[["flexbox",[["style",["flex_wrap","justify_content","flex_direction","align_content","align_items","gap"],"display: flex; flex-wrap: {flex_wrap}; justify-content: {justify_content}; flex-direction: {flex_direction}; align-content: {align_content}; align-items: {align_items}; gap: {gap}; height: 100%;"]]]]},"children":{"type":"map","entries":[["flex-item",[{"type":"object","name":"panel.models.layout.Card","id":"p1070","attributes":{"name":"Card00176","css_classes":["card"],"styles":{"type":"map","entries":[["width","fit-content"]]},"stylesheets":["\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1006"},{"id":"p1007"},{"id":"p1005"}],"margin":10,"sizing_mode":"stretch_width","align":"start","children":[{"type":"object","name":"Row","id":"p1078","attributes":{"name":"Row00175","css_classes":["card-header-row"],"stylesheets":["\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1006"},{"id":"p1007"},{"id":"p1005"}],"margin":0,"sizing_mode":"stretch_width","align":"start","children":[{"type":"object","name":"panel.models.markup.HTML","id":"p1079","attributes":{"css_classes":["card-title"],"stylesheets":["\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1006"},{"id":"p1005"}],"margin":[5,0],"align":"start","text":"&amp;lt;h3&amp;gt;Admixture model&amp;lt;/h3&amp;gt;","disable_math":true}}]}},{"type":"object","name":"panel.models.reactive_html.ReactiveHTML","id":"p1072","attributes":{"subscribed_events":{"type":"set","entries":["dom_event"]},"stylesheets":["\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1006"},{"id":"p1005"}],"margin":0,"sizing_mode":"stretch_width","align":"start","attrs":{"type":"map","entries":[["flexbox",[["style",["flex_wrap","justify_content","flex_direction","align_content","align_items","gap"],"display: flex; flex-wrap: {flex_wrap}; justify-content: {justify_content}; flex-direction: {flex_direction}; align-content: {align_content}; align-items: {align_items}; gap: {gap}; height: 100%;"]]]]},"children":{"type":"map","entries":[["flex-item",[{"type":"object","name":"panel.models.widgets.SingleSelect","id":"p1074","attributes":{"stylesheets":["\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1006"},{"type":"object","name":"ImportedStyleSheet","id":"p1073","attributes":{"url":"https://cdn.holoviz.org/panel/1.5.0-b.3/dist/css/select.css"}},{"id":"p1005"}],"width":300,"min_width":300,"margin":[5,10],"align":"start","title":"Hybrid","size":10}},{"type":"object","name":"panel.models.widgets.SingleSelect","id":"p1075","attributes":{"stylesheets":["\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1006"},{"id":"p1073"},{"id":"p1005"}],"width":300,"min_width":300,"margin":[5,10],"align":"start","title":"Parent 1","size":10}},{"type":"object","name":"panel.models.widgets.SingleSelect","id":"p1076","attributes":{"stylesheets":["\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1006"},{"id":"p1073"},{"id":"p1005"}],"width":300,"min_width":300,"margin":[5,10],"align":"start","title":"Parent 2","size":10}},{"type":"object","name":"panel.models.widgets.CustomMultiSelect","id":"p1077","attributes":{"subscribed_events":{"type":"set","entries":["dblclick_event"]},"stylesheets":["\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1006"},{"id":"p1073"},{"id":"p1005"}],"width":300,"min_width":300,"margin":[5,10],"align":"start","title":"Auxiliaries","size":10}}]]]},"data":{"type":"object","name":"FlexBox1","id":"p1071","attributes":{"name":"FlexBox00174","justify_content":"space-evenly"}},"html":"&amp;lt;div id=&amp;quot;flexbox-${id}&amp;quot; style=&amp;quot;display: flex; flex-wrap: ${flex_wrap}; justify-content: ${justify_content}; flex-direction: ${flex_direction}; align-content: ${align_content}; align-items: ${align_items}; gap: ${gap}; height: 100%;&amp;quot;&amp;gt;\n\n  &amp;lt;div id=&amp;quot;flex-item-0-${id}&amp;quot; style=&amp;quot;display: contents;&amp;quot;&amp;gt;\n\n  &amp;lt;/div&amp;gt;\n\n  &amp;lt;div id=&amp;quot;flex-item-1-${id}&amp;quot; style=&amp;quot;display: contents;&amp;quot;&amp;gt;\n\n  &amp;lt;/div&amp;gt;\n\n  &amp;lt;div id=&amp;quot;flex-item-2-${id}&amp;quot; style=&amp;quot;display: contents;&amp;quot;&amp;gt;\n\n  &amp;lt;/div&amp;gt;\n\n  &amp;lt;div id=&amp;quot;flex-item-3-${id}&amp;quot; style=&amp;quot;display: contents;&amp;quot;&amp;gt;\n\n  &amp;lt;/div&amp;gt;\n\n&amp;lt;/div&amp;gt;","looped":["flex-item"],"nodes":["flexbox","flex-item-0","flex-item-1","flex-item-2","flex-item-3"]}}],"active_header_background":"","button_css_classes":["card-button"],"collapsed":false,"collapsible":false,"header_background":"","header_color":"","header_css_classes":["card-header"]}},{"type":"object","name":"panel.models.layout.Card","id":"p1080","attributes":{"name":"Card00180","css_classes":["card"],"styles":{"type":"map","entries":[["width","fit-content"]]},"stylesheets":["\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1006"},{"id":"p1007"},{"id":"p1005"}],"margin":10,"align":"start","children":[{"type":"object","name":"Row","id":"p1084","attributes":{"name":"Row00179","css_classes":["card-header-row"],"stylesheets":["\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1006"},{"id":"p1007"},{"id":"p1005"}],"margin":0,"sizing_mode":"stretch_width","align":"start","children":[{"type":"object","name":"panel.models.markup.HTML","id":"p1085","attributes":{"css_classes":["card-title"],"stylesheets":["\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1006"},{"id":"p1005"}],"margin":[5,0],"align":"start","text":"&amp;lt;h3&amp;gt;Actions&amp;lt;/h3&amp;gt;","disable_math":true}}]}},{"type":"object","name":"panel.models.widgets.Button","id":"p1081","attributes":{"button_type":"primary","subscribed_events":{"type":"set","entries":["button_click"]},"css_classes":["solid"],"stylesheets":["\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1006"},{"id":"p1038"},{"id":"p1005"}],"disabled":true,"margin":[5,10],"align":"start","label":"Compute results"}},{"type":"object","name":"panel.models.widgets.FileDownload","id":"p1082","attributes":{"css_classes":["solid"],"stylesheets":["\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1006"},{"id":"p1038"},{"id":"p1005"}],"disabled":true,"margin":[5,10],"align":"start","auto":true,"button_type":"primary","label":"Download f4-points"}},{"type":"object","name":"panel.models.widgets.FileDownload","id":"p1083","attributes":{"css_classes":["solid"],"stylesheets":["\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1006"},{"id":"p1038"},{"id":"p1005"}],"disabled":true,"margin":[5,10],"align":"start","auto":true,"button_type":"primary","label":"Download results"}}],"active_header_background":"","button_css_classes":["card-button"],"collapsed":false,"collapsible":false,"header_background":"","header_color":"","header_css_classes":["card-header"]}},{"type":"object","name":"panel.models.layout.Card","id":"p1086","attributes":{"name":"Card00184","css_classes":["card"],"styles":{"type":"map","entries":[["width","fit-content"]]},"stylesheets":["\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1006"},{"id":"p1007"},{"id":"p1005"}],"margin":10,"align":"start","children":[{"type":"object","name":"Row","id":"p1091","attributes":{"name":"Row00183","css_classes":["card-header-row"],"stylesheets":["\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1006"},{"id":"p1007"},{"id":"p1005"}],"margin":0,"sizing_mode":"stretch_width","align":"start","children":[{"type":"object","name":"panel.models.markup.HTML","id":"p1092","attributes":{"css_classes":["card-title"],"stylesheets":["\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1006"},{"id":"p1005"}],"margin":[5,0],"align":"start","text":"&amp;lt;h3&amp;gt;Plot options&amp;lt;/h3&amp;gt;","disable_math":true}}]}},{"type":"object","name":"Spinner","id":"p1087","attributes":{"stylesheets":["\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1006"},{"id":"p1005"}],"width":300,"min_width":300,"margin":[5,10],"align":"start","title":"Plot width (inches)","value":4,"low":0.1,"step":0.1}},{"type":"object","name":"Spinner","id":"p1088","attributes":{"stylesheets":["\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1006"},{"id":"p1005"}],"width":300,"min_width":300,"margin":[5,10],"align":"start","title":"Plot height (inches)","value":4,"low":0.1,"step":0.1}},{"type":"object","name":"Spinner","id":"p1089","attributes":{"stylesheets":["\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1006"},{"id":"p1005"}],"width":300,"min_width":300,"margin":[5,10],"align":"start","title":"Plot title font size","value":10,"low":1,"placeholder":"0","mode":"int"}},{"type":"object","name":"Spinner","id":"p1090","attributes":{"stylesheets":["\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1006"},{"id":"p1005"}],"width":300,"min_width":300,"margin":[5,10],"align":"start","title":"Plot labels font size","value":10,"low":1,"placeholder":"0","mode":"int"}}],"active_header_background":"","button_css_classes":["card-button"],"collapsed":false,"collapsible":false,"header_background":"","header_color":"","header_css_classes":["card-header"]}},{"type":"object","name":"panel.models.layout.Card","id":"p1093","attributes":{"name":"Card00188","css_classes":["card"],"styles":{"type":"map","entries":[["width","fit-content"]]},"stylesheets":["\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1006"},{"id":"p1007"},{"id":"p1005"}],"margin":10,"align":"start","children":[{"type":"object","name":"Row","id":"p1096","attributes":{"name":"Row00187","css_classes":["card-header-row"],"stylesheets":["\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1006"},{"id":"p1007"},{"id":"p1005"}],"margin":0,"sizing_mode":"stretch_width","align":"start","children":[{"type":"object","name":"panel.models.markup.HTML","id":"p1097","attributes":{"css_classes":["card-title"],"stylesheets":["\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1006"},{"id":"p1005"}],"margin":[5,0],"align":"start","text":"&amp;lt;h3&amp;gt;Results&amp;lt;/h3&amp;gt;","disable_math":true}}]}},{"type":"object","name":"panel.models.markup.HTML","id":"p1095","attributes":{"css_classes":["markdown"],"stylesheets":["\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1006"},{"type":"object","name":"ImportedStyleSheet","id":"p1094","attributes":{"url":"https://cdn.holoviz.org/panel/1.5.0-b.3/dist/css/markdown.css"}},{"id":"p1005"}],"margin":[5,10],"align":"start"}}],"active_header_background":"","button_css_classes":["card-button"],"collapsed":false,"collapsible":false,"header_background":"","header_color":"","header_css_classes":["card-header"]}},{"type":"object","name":"panel.models.layout.Card","id":"p1098","attributes":{"name":"Card00193","css_classes":["card"],"styles":{"type":"map","entries":[["width","fit-content"]]},"stylesheets":["\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1006"},{"id":"p1007"},{"id":"p1005"}],"margin":10,"sizing_mode":"stretch_width","align":"start","children":[{"type":"object","name":"Row","id":"p1104","attributes":{"name":"Row00192","css_classes":["card-header-row"],"stylesheets":["\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1006"},{"id":"p1007"},{"id":"p1005"}],"margin":0,"sizing_mode":"stretch_width","align":"start","children":[{"type":"object","name":"panel.models.markup.HTML","id":"p1105","attributes":{"css_classes":["card-title"],"stylesheets":["\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1006"},{"id":"p1005"}],"margin":[5,0],"align":"start","text":"&amp;lt;h3&amp;gt;Plots&amp;lt;/h3&amp;gt;","disable_math":true}}]}},{"type":"object","name":"panel.models.reactive_html.ReactiveHTML","id":"p1100","attributes":{"subscribed_events":{"type":"set","entries":["dom_event"]},"stylesheets":["\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1006"},{"id":"p1005"}],"margin":0,"sizing_mode":"stretch_width","align":"start","attrs":{"type":"map","entries":[["flexbox",[["style",["flex_wrap","justify_content","flex_direction","align_content","align_items","gap"],"display: flex; flex-wrap: {flex_wrap}; justify-content: {justify_content}; flex-direction: {flex_direction}; align-content: {align_content}; align-items: {align_items}; gap: {gap}; height: 100%;"]]]]},"children":{"type":"map","entries":[["flex-item",[{"type":"object","name":"panel.models.markup.HTML","id":"p1101","attributes":{"stylesheets":["\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1006"},{"id":"p1005"}],"margin":10,"align":["center","start"],"text":"&lt;img&gt;&lt;/img&gt;"}},{"type":"object","name":"panel.models.markup.HTML","id":"p1102","attributes":{"stylesheets":["\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1006"},{"id":"p1005"}],"margin":10,"align":["center","start"],"text":"&lt;img&gt;&lt;/img&gt;"}},{"type":"object","name":"panel.models.markup.HTML","id":"p1103","attributes":{"stylesheets":["\n:host(.pn-loading):before, .pn-loading:before {\n  background-color: #c3c3c3;\n  mask-size: auto calc(min(50%, 400px));\n  -webkit-mask-size: auto calc(min(50%, 400px));\n}",{"id":"p1006"},{"id":"p1005"}],"margin":10,"align":["center","start"],"text":"&lt;img&gt;&lt;/img&gt;"}}]]]},"data":{"type":"object","name":"FlexBox1","id":"p1099","attributes":{"name":"FlexBox00191","justify_content":"space-evenly"}},"html":"&amp;lt;div id=&amp;quot;flexbox-${id}&amp;quot; style=&amp;quot;display: flex; flex-wrap: ${flex_wrap}; justify-content: ${justify_content}; flex-direction: ${flex_direction}; align-content: ${align_content}; align-items: ${align_items}; gap: ${gap}; height: 100%;&amp;quot;&amp;gt;\n\n  &amp;lt;div id=&amp;quot;flex-item-0-${id}&amp;quot; style=&amp;quot;display: contents;&amp;quot;&amp;gt;\n\n  &amp;lt;/div&amp;gt;\n\n  &amp;lt;div id=&amp;quot;flex-item-1-${id}&amp;quot; style=&amp;quot;display: contents;&amp;quot;&amp;gt;\n\n  &amp;lt;/div&amp;gt;\n\n  &amp;lt;div id=&amp;quot;flex-item-2-${id}&amp;quot; style=&amp;quot;display: contents;&amp;quot;&amp;gt;\n\n  &amp;lt;/div&amp;gt;\n\n&amp;lt;/div&amp;gt;","looped":["flex-item"],"nodes":["flexbox","flex-item-0","flex-item-1","flex-item-2"]}}],"active_header_background":"","button_css_classes":["card-button"],"collapsed":false,"collapsible":false,"header_background":"","header_color":"","header_css_classes":["card-header"]}}]]]},"data":{"type":"object","name":"FlexBox1","id":"p1068","attributes":{"name":"Results","justify_content":"space-evenly"}},"html":"&amp;lt;div id=&amp;quot;flexbox-${id}&amp;quot; style=&amp;quot;display: flex; flex-wrap: ${flex_wrap}; justify-content: ${justify_content}; flex-direction: ${flex_direction}; align-content: ${align_content}; align-items: ${align_items}; gap: ${gap}; height: 100%;&amp;quot;&amp;gt;\n\n  &amp;lt;div id=&amp;quot;flex-item-0-${id}&amp;quot; style=&amp;quot;display: contents;&amp;quot;&amp;gt;\n\n  &amp;lt;/div&amp;gt;\n\n  &amp;lt;div id=&amp;quot;flex-item-1-${id}&amp;quot; style=&amp;quot;display: contents;&amp;quot;&amp;gt;\n\n  &amp;lt;/div&amp;gt;\n\n  &amp;lt;div id=&amp;quot;flex-item-2-${id}&amp;quot; style=&amp;quot;display: contents;&amp;quot;&amp;gt;\n\n  &amp;lt;/div&amp;gt;\n\n  &amp;lt;div id=&amp;quot;flex-item-3-${id}&amp;quot; style=&amp;quot;display: contents;&amp;quot;&amp;gt;\n\n  &amp;lt;/div&amp;gt;\n\n  &amp;lt;div id=&amp;quot;flex-item-4-${id}&amp;quot; style=&amp;quot;display: contents;&amp;quot;&amp;gt;\n\n  &amp;lt;/div&amp;gt;\n\n&amp;lt;/div&amp;gt;","looped":["flex-item"],"nodes":["flexbox","flex-item-0","flex-item-1","flex-item-2","flex-item-3","flex-item-4"]}}}}]}}]}}],"defs":[{"type":"model","name":"ReactiveHTML1"},{"type":"model","name":"FlexBox1","properties":[{"name":"align_content","kind":"Any","default":"flex-start"},{"name":"align_items","kind":"Any","default":"flex-start"},{"name":"flex_direction","kind":"Any","default":"row"},{"name":"flex_wrap","kind":"Any","default":"wrap"},{"name":"gap","kind":"Any","default":""},{"name":"justify_content","kind":"Any","default":"flex-start"}]},{"type":"model","name":"FloatPanel1","properties":[{"name":"config","kind":"Any","default":{"type":"map"}},{"name":"contained","kind":"Any","default":true},{"name":"position","kind":"Any","default":"right-top"},{"name":"offsetx","kind":"Any","default":null},{"name":"offsety","kind":"Any","default":null},{"name":"theme","kind":"Any","default":"primary"},{"name":"status","kind":"Any","default":"normalized"}]},{"type":"model","name":"GridStack1","properties":[{"name":"mode","kind":"Any","default":"warn"},{"name":"ncols","kind":"Any","default":null},{"name":"nrows","kind":"Any","default":null},{"name":"allow_resize","kind":"Any","default":true},{"name":"allow_drag","kind":"Any","default":true},{"name":"state","kind":"Any","default":[]}]},{"type":"model","name":"drag1","properties":[{"name":"slider_width","kind":"Any","default":5},{"name":"slider_color","kind":"Any","default":"black"},{"name":"value","kind":"Any","default":50}]},{"type":"model","name":"click1","properties":[{"name":"terminal_output","kind":"Any","default":""},{"name":"debug_name","kind":"Any","default":""},{"name":"clears","kind":"Any","default":0}]},{"type":"model","name":"FastWrapper1","properties":[{"name":"object","kind":"Any","default":null},{"name":"style","kind":"Any","default":null}]},{"type":"model","name":"NotificationAreaBase1","properties":[{"name":"js_events","kind":"Any","default":{"type":"map"}},{"name":"position","kind":"Any","default":"bottom-right"},{"name":"_clear","kind":"Any","default":0}]},{"type":"model","name":"NotificationArea1","properties":[{"name":"js_events","kind":"Any","default":{"type":"map"}},{"name":"notifications","kind":"Any","default":[]},{"name":"position","kind":"Any","default":"bottom-right"},{"name":"_clear","kind":"Any","default":0},{"name":"types","kind":"Any","default":[{"type":"map","entries":[["type","warning"],["background","#ffc107"],["icon",{"type":"map","entries":[["className","fas fa-exclamation-triangle"],["tagName","i"],["color","white"]]}]]},{"type":"map","entries":[["type","info"],["background","#007bff"],["icon",{"type":"map","entries":[["className","fas fa-info-circle"],["tagName","i"],["color","white"]]}]]}]}]},{"type":"model","name":"Notification","properties":[{"name":"background","kind":"Any","default":null},{"name":"duration","kind":"Any","default":3000},{"name":"icon","kind":"Any","default":null},{"name":"message","kind":"Any","default":""},{"name":"notification_type","kind":"Any","default":null},{"name":"_destroyed","kind":"Any","default":false}]},{"type":"model","name":"TemplateActions1","properties":[{"name":"open_modal","kind":"Any","default":0},{"name":"close_modal","kind":"Any","default":0}]},{"type":"model","name":"BootstrapTemplateActions1","properties":[{"name":"open_modal","kind":"Any","default":0},{"name":"close_modal","kind":"Any","default":0}]},{"type":"model","name":"TemplateEditor1","properties":[{"name":"layout","kind":"Any","default":[]}]},{"type":"model","name":"MaterialTemplateActions1","properties":[{"name":"open_modal","kind":"Any","default":0},{"name":"close_modal","kind":"Any","default":0}]},{"type":"model","name":"copy_to_clipboard1","properties":[{"name":"fill","kind":"Any","default":"none"},{"name":"value","kind":"Any","default":null}]}]}}
    </script>
    <script type="text/javascript">
      (function() {
        const fn = function() {
          Bokeh.safely(function() {
            (function(root) {
              function embed_document(root) {
              const docs_json = document.getElementById('p1125').textContent;
              const render_items = [{"docid":"b32efed9-5005-4348-a56d-32d9de9f40c6","roots":{"p1002":"a24e9980-6ead-4a99-8457-28cd5393503e","p1008":"dda4e455-a549-4269-914b-578d2206abf5","p1010":"abb4e279-56c1-46be-84d3-d71adbf04eb8","p1011":"e2bdd23f-0e00-443d-bea3-a4d8cc7fde99","p1013":"eff3c580-31c0-4ef9-a1d3-92d132000135","p1014":"e1951108-e9a5-4bd4-985c-b104277be3bd"},"root_ids":["p1002","p1008","p1010","p1011","p1013","p1014"]}];
              root.Bokeh.embed.embed_items(docs_json, render_items);
              }
              if (root.Bokeh !== undefined) {
                embed_document(root);
              } else {
                let attempts = 0;
                const timer = setInterval(function(root) {
                  if (root.Bokeh !== undefined) {
                    clearInterval(timer);
                    embed_document(root);
                  } else {
                    attempts++;
                    if (attempts > 100) {
                      clearInterval(timer);
                      console.log("Bokeh: ERROR: Unable to run BokehJS code because BokehJS library is missing");
                    }
                  }
                }, 10, root)
              }
            })(window);
          });
        };
        if (document.readyState != "loading") fn();
      else document.addEventListener("DOMContentLoaded", fn, {once: true});
      })();
    </script>
  </body>
</html>